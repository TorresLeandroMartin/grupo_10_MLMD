<!DOCTYPE html>
<html lang="en">

<!-- head -->

<%- include("./partials/head") %>

    <!-- hoja de estilos -->

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="/css/stylesRegister.css">

    <body>

        <!-- header -->

        <%- include("./partials/header") %>


            <main>

                <div class="contenedor-main">


                    <div class="top">
                        <p>EDITA TU CUENTA</p>
                    </div>

                    <hr class="linea-divisoria2">

                    <form method="POST" name="file" action="/usuarios/edicionUsuario/<%=user.id%>?_method=PUT"  class="bottom" enctype="multipart/form-data">

                        <div class="campos-de-relleno">
                            <p>Imagen de perfil</p>
                            <input 
                            type="file" name="imagen"id="imagen" class="letrasTipoArchivo" 
                            
                            value="<%- locals.oldData ? oldData.imagen : user.imagen %>">

                            <div class="imagenErrors">
                                <p id="formatoImagen"></p>
                                <p id="tamañoImagen"></p>
                                <p id="archivoImagen"></p>
                            </div>

                            <% if (locals.errors && errors.imagen) { %>
                                <div class="texto-error">
                                    <%= errors.imagen.msg %>
                                </div>
                            <% } %>
                            <img src="/img/avatars/<%- user.imagen %>">
                        </div>

                        <div class="campos-de-relleno">
                            <div>
                            <p>Nombre y Apellido</p>
                            <input 
                            type="text" name="nombre" id="nombre" placeholder="Nombre y Apellido"
                            class="campo-individual" value="<%- locals.oldData ? oldData.nombre : user.nombre %>">

                            <div class="nombreErrors is-invalid"></div>

                            <% if (locals.errors && errors.nombre) { %>
                                <div class="texto-error">
                                    <%= errors.nombre.msg %>
                                </div>
                                <% } %>
                            
                        </div>

                    </div>

                    
                        <div class="campos-de-relleno">
                            <div>
                            <p>Email</p>
                            <input   
                            type="email" 
                            name="email" 
                            id="email"
                            class="campo-individual"
                            value="<%= locals.oldData ? oldData.email : user.email %>"
                            placeholder="email@dirección.com">


                            <div class="emailErrors">
                                <p id="mensaje"></p>
                                <p id="mensaje2"></p>
                            </div>


                            <% if (locals.errors && errors.email) { %>
                                <div class="texto-error">
                                    <%= errors.email.msg %>
                                </div>
                                <% } %>
                        </div>
                       
                    </div>

                    
                        <div class="campos-de-relleno">
                            <div>
                            <p>Teléfono</p>
                            <input
                            type="tel" 
                            name="telefono" 
                            id="telefono"
                            placeholder="num. de teléfono"
                            class="campo-individual"
                            value="<%- locals.oldData ? oldData.telefono : user.telefono %>"
                            >

                            <div class="telefonoErrors is-invalid">
                                <p id="mensaje"></p>
                                <p id="numeric"></p>
                            </div>

                            <% if (locals.errors && errors.telefono) { %>
                                <div class="texto-error">
                                    <%= errors.telefono.msg %>
                                </div>
                                <% } %>
                        </div>
                    </div>

                    
                        <div class="campos-de-relleno">
                            <div>
              
                            <p>Categoría</p>
                            <select name="categoria" id="categoria" class="campo-individual"
                               value =" <%- locals.oldData ? oldData.categoria : user.categoria %>">


                                <% let categorias=["", "Cliente", "Vendedor" ]; %>
                                    <% for(const unaCategoria of categorias) { %>
                                        <option value="<%= unaCategoria %>">
                                            <%= locals.oldData && (unaCategoria==oldData.categoria) ?
                                                oldData.categoria : null%>
                                                <%= unaCategoria %>
                                        </option>
                                        <% } %>
                            </select>

                            <div class="categoriaErrors is-invalid">
                                <p id="archivoCategoria"></p>
                            </div>

                            <% if (locals.errors && errors.categoria) { %>
                                <div class="texto-error">
                                    <%= errors.categoria.msg %>
                                </div>
                                <% } %>
                        </div>
                    </div>

                   
                        <div class="campos-de-relleno">
                            <div>
                            <p>Contraseña</p>
                            <input   
                            type="password" 
                            name="contrasena" 
                            id="contraseña" 
                            placeholder="**********"
                            pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}" 
                            class="campo-individual"
                            value="<%- locals.oldData ? oldData.contrasena : user.contraseña %>"
                            >
                            <% if (locals.errors && errors.contrasena) { %>
                                <div class="texto-error">
                                    <%= errors.contrasena.msg %>
                                </div>
                                <% } %>


                                <div class="contrasenaError">
                                    <p id="minuscula"></p>
                                    <p id="mayuscula"></p>
                                    <p id="numero"></p>
                                    <p id="cantidad"></p>
                                </div>
                        </div>
                       
                    </div>

                        <div class="campos-de-relleno">
                                <button type="submit" class="boton2">Editar</button>
                        </div>

                    </form>

                </div>




            </main>

            <!-- footer -->

            <%- include("./partials/footer") %>

            <script src="/js/validacionesEdicionUsuarioFront.js"></script>

    </body>

</html>